<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Treina-DEV | Route Tracker</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              black: '#0a0a0a',
              purple: '#8b5cf6',
              purpleDark: '#6d28d9',
              gray: '#1f1f1f'
            }
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #0a0a0a; }
    ::-webkit-scrollbar-thumb { background: #8b5cf6; border-radius: 10px; }
    
    /* Efeito de brilho no mapa */
    #map { filter: grayscale(1) invert(1) contrast(0.9); }
    .leaflet-container { background: #0a0a0a !important; }
  </style>
</head>

<body class="bg-brand-black text-gray-100 min-h-screen font-sans selection:bg-brand-purple">

  <main class="w-full max-w-md mx-auto p-6 flex flex-col gap-6 md:max-w-4xl md:py-12">
    
    <header class="text-center space-y-2">
      <h1 class="text-3xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-white to-brand-purple">
        Treina-DEV House Route Tracker
      </h1>
      <h3 class="text-center space-y-2">Rastreamento de Rota em Tempo Real</h3>
      <p class="text-gray-400 text-sm">Destino: CEP 74961-070</p>
    </header>

    <section class="bg-brand-gray/50 backdrop-blur-md border border-white/10 p-6 rounded-3xl shadow-2xl space-y-6">
      
      <button
        id="btn"
        class="w-full py-4 bg-brand-purple hover:bg-brand-purpleDark text-white font-bold rounded-2xl transition-all duration-300 transform active:scale-95 shadow-[0_0_20px_rgba(139,92,246,0.3)] flex items-center justify-center gap-2"
      >
        <span>ğŸ“</span> Calcular Rota Agora
      </button>

      <p id="info" class="text-center text-xs font-medium text-brand-purple animate-pulse"></p>

      <div class="relative group">
        <div class="absolute -inset-1 bg-gradient-to-r from-brand-purple to-purple-900 rounded-2xl blur opacity-25 group-hover:opacity-50 transition duration-1000"></div>
        <div id="map" class="relative w-full h-[300px] md:h-[450px] rounded-2xl border border-white/5 overflow-hidden"></div>
      </div>

    </section>

    <section id="results" class="grid grid-cols-1 md:grid-cols-3 gap-4 opacity-0 transition-opacity duration-500">
      <div class="bg-brand-gray/40 border border-white/5 p-4 rounded-2xl flex flex-col items-center">
        <span class="text-2xl mb-1">ğŸ“</span>
        <span class="text-gray-400 text-xs uppercase tracking-widest">DistÃ¢ncia</span>
        <p id="distance" class="text-lg font-bold text-white"></p>
      </div>
      
      <div class="bg-brand-gray/40 border border-white/5 p-4 rounded-2xl flex flex-col items-center">
        <span class="text-2xl mb-1">ğŸš—</span>
        <span class="text-gray-400 text-xs uppercase tracking-widest">Tempo Carro</span>
        <p id="carTime" class="text-lg font-bold text-white"></p>
      </div>

      <div class="bg-brand-gray/40 border border-white/5 p-4 rounded-2xl flex flex-col items-center">
        <span class="text-2xl mb-1">ğŸï¸</span>
        <span class="text-gray-400 text-xs uppercase tracking-widest">Tempo Moto</span>
        <p id="bikeTime" class="text-lg font-bold text-white"></p>
      </div>
    </section>

  </main>

<script>
  const btn = document.getElementById("btn")
  const info = document.getElementById("info")
  const results = document.getElementById("results")
  const distanceEl = document.getElementById("distance")
  const carTimeEl = document.getElementById("carTime")
  const bikeTimeEl = document.getElementById("bikeTime")

  const targetLat = -16.8236
  const targetLng = -49.2469

  let map
  let routeLayer

  btn.addEventListener("click", () => {
    info.textContent = "Acessando GPS..."

    navigator.geolocation.getCurrentPosition(async (pos) => {
      const userLat = pos.coords.latitude
      const userLng = pos.coords.longitude

      info.textContent = "TraÃ§ando melhor caminho..."

      if (!map) {
        map = L.map("map", { zoomControl: false }).setView([userLat, userLng], 13)
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map)
      }

      if (routeLayer) map.removeLayer(routeLayer)

      const url = `https://router.project-osrm.org/route/v1/driving/${userLng},${userLat};${targetLng},${targetLat}?overview=full&geometries=geojson`.replace(/\s+/g, "")

      try {
        const res = await fetch(url)
        const data = await res.json()
        const route = data.routes[0]

        const distanceKm = (route.distance / 1000).toFixed(1)
        const carMinutes = Math.round(route.duration / 60)
        const bikeMinutes = Math.round(carMinutes * 0.85)

        routeLayer = L.geoJSON(route.geometry, {
          style: { color: '#8b5cf6', weight: 5, opacity: 0.8 }
        }).addTo(map)

        // Ãcones customizados (Emoji como marcador simples)
        const userIcon = L.divIcon({ html: 'ğŸ”µ', className: 'text-xl', iconSize: [20, 20] })
        const destIcon = L.divIcon({ html: 'ğŸ', className: 'text-xl', iconSize: [20, 20] })

        L.marker([userLat, userLng], { icon: userIcon }).addTo(map)
        L.marker([targetLat, targetLng], { icon: destIcon }).addTo(map)

        map.fitBounds(routeLayer.getBounds(), { padding: [30, 30] })

        // Exibir resultados com animaÃ§Ã£o
        results.classList.remove('opacity-0')
        distanceEl.textContent = `${distanceKm} km`
        carTimeEl.textContent = `${carMinutes} min`
        bikeTimeEl.textContent = `${bikeMinutes} min`

        info.textContent = "Rota calculada com sucesso!"
        setTimeout(() => info.textContent = "", 3000)
      } catch (err) {
        info.textContent = "Erro ao calcular rota."
      }
    }, 
    () => info.textContent = "ğŸ“ Ative o GPS para continuar.")
  })
</script>

</body>
</html>